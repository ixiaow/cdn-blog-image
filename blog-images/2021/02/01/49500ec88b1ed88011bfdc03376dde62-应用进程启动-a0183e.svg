<?xml version="1.0" standalone="no"?>
<svg style="background: #fff" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="770px" height="670px" viewBox="-0.5 -0.5 770 670"><defs><style>* {margin: 0px; padding: 0px;}</style></defs><g><path d="M 107 33 L 164.63 33" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 169.88 33 L 162.88 36.5 L 164.63 33 L 162.88 29.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 37.61 6 L 76.39 6 C 93.29 6 107 18.09 107 33 C 107 47.91 93.29 60 76.39 60 L 37.61 60 C 20.71 60 7 47.91 7 33 C 7 18.09 20.71 6 37.61 6 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="56.5" y="36.5">开始</text></g><path d="M 321 33 L 381.63 33" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 386.88 33 L 379.88 36.5 L 381.63 33 L 379.88 29.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="171" y="0" width="150" height="66" rx="4.62" ry="4.62" fill="#ffffff" stroke="#000000" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="245.5" y="22.5">AMS调用</text><text x="245.5" y="36.5">startProcessLocked()</text><text x="245.5" y="50.5">向Zygote发送请求</text></g><path d="M 538 33 L 597.63 33" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 602.88 33 L 595.88 36.5 L 597.63 33 L 595.88 29.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="388" y="0" width="150" height="66" rx="4.62" ry="4.62" fill="#ffffff" stroke="#000000" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="462.5" y="36.5">Process.start()</text></g><path d="M 679 66 L 679 127.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 679 132.88 L 675.5 125.88 L 679 127.63 L 682.5 125.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="604" y="0" width="150" height="66" rx="4.62" ry="4.62" fill="#ffffff" stroke="#000000" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="678.5" y="36.5">ZygoteProcess.start()</text></g><path d="M 604 168.5 L 554.37 168.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 549.12 168.5 L 556.12 165 L 554.37 168.5 L 556.12 172 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 679 203 L 679 296.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 679 301.88 L 675.5 294.88 L 679 296.63 L 682.5 294.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="604" y="134" width="150" height="69" rx="4.83" ry="4.83" fill="#ffffff" stroke="#000000" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="678.5" y="151">startViaZygote()创建</text><text x="678.5" y="165">单链表argsForZygote</text><text x="678.5" y="179">并将应用的启动参数</text><text x="678.5" y="193">保存其中</text></g><rect x="589.5" y="303" width="179" height="69" rx="4.83" ry="4.83" fill="#ffffff" stroke="#000000" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="678.5" y="320">zygoteSendArgsAndGetResult()</text><text x="678.5" y="334">其中会有一个</text><text x="678.5" y="348">openZygoteSocketIfNeeded()</text><text x="678.5" y="362">参数返回ZygoteState</text></g><path d="M 398 168.5 L 337.37 168.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 332.12 168.5 L 339.12 165 L 337.37 168.5 L 339.12 172 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="398" y="134" width="150" height="69" rx="4.83" ry="4.83" fill="#ffffff" stroke="#000000" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="472.5" y="165">openZygote</text><text x="472.5" y="179">SocketIfNeeded()</text></g><path d="M 181 168.5 L 132.37 168.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 127.12 168.5 L 134.12 165 L 132.37 168.5 L 134.12 172 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 256 203 L 256 287.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 256 292.88 L 252.5 285.88 L 256 287.63 L 259.5 285.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="181" y="134" width="150" height="69" rx="4.83" ry="4.83" fill="#ffffff" stroke="#000000" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="255.5" y="151">创建Socket,</text><text x="255.5" y="165">开始死循环，用于等待AMS</text><text x="255.5" y="179">请求Zygote来创建新的应用</text><text x="255.5" y="193">程序进程</text></g><rect x="0" y="134" width="126" height="69" rx="4.83" ry="4.83" fill="#ffffff" stroke="#000000" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="62.5" y="172">Zygote进程启动</text></g><path d="M 335 338 L 361 338 L 380.63 338" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 385.88 338 L 378.88 341.5 L 380.63 338 L 378.88 334.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 256 381 L 256 442.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 256 447.88 L 252.5 440.88 L 256 442.63 L 259.5 440.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 256 294 L 335 337.5 L 256 381 L 177 337.5 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="255.5" y="334">当AMS有请求</text><text x="255.5" y="348">数据过来</text></g><path d="M 256 520 L 256 593.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 256 598.88 L 252.5 591.88 L 256 593.63 L 259.5 591.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="181" y="451" width="150" height="69" rx="4.83" ry="4.83" fill="#ffffff" stroke="#000000" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="255.5" y="482">...最终在Zygote</text><text x="255.5" y="496">.methodAndArgsCaller()中</text></g><rect x="150.5" y="600" width="211" height="69" rx="4.83" ry="4.83" fill="#ffffff" stroke="#000000" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="255.5" y="617">调用mMethod的invoke方法后，</text><text x="255.5" y="631">ActivityThread的main方法</text><text x="255.5" y="645">就会被动态调用，应用程序就</text><text x="255.5" y="659">进入ActivtyThread的main方法中</text></g><rect x="388" y="305.5" width="150" height="69" rx="4.83" ry="4.83" fill="#ffffff" stroke="#000000" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="462.5" y="343.5">休眠</text></g><g transform="translate(266.5,413.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="8" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Y</div></div></foreignObject></g><g transform="translate(367.5,324.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="9" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">N</div></div></foreignObject></g><g transform="translate(552.5,235.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="121" height="40"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">ZygoteState类（<br/>主要用于与Zygote进程<br/>通信的状态）</div></div></foreignObject></g></g></svg>